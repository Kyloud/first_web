<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="UTF-8">
		<title>Employees Table</title>
		
		
		<!-- Icon Font Stylesheet -->
	    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
	    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
	
	    <!-- Libraries Stylesheet -->
	    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
	    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />
	
	    <!-- Customized Bootstrap Stylesheet -->
	    <link href="css/bootstrap.min.css" rel="stylesheet">
	
	    <!-- Template Stylesheet -->
	    <link href="css/style.css" rel="stylesheet">
	</head>

	<body>
		<th:block th:insert="~{fragments_sidebar::sidebar}"></th:block>
		<div class="content">
			<div class="bg-secondary rounded h-100 p-4">
				<h3 class="mb-4">employees Table INFO</h3>
				<div class="bg-secondary rounded h-100 p-4">
					<table class="table">
						<thead>
							<tr>
								<th scope="col">emp_no</th>
								<th scope="col">birth_date</th>
								<th scope="col">first_name</th>
								<th scope="col">last_name</th>
								<th scope="col">gender</th>
								<th scope="col">hire_date</th>
							</tr>
						</thead>	
					
						<tbody>
							<tr th:each="employee:${employees}">
								<td scope="row" th:text="${employee.emp_no}"></td>
								<td scope="row" th:text="${employee.birth_date}"></td>
								<td scope="row" th:text="${employee.first_name}"></td>
								<td scope="row" th:text="${employee.last_name}"></td>
								<td scope="row" th:text="${employee.gender}"></td>
								<td scope="row" th:text="${employee.hire_date}"></td>
							</tr>
						</tbody>
					</table>	
				</div>
				
				<nav aria-label = "Page Navigation example" style = "width:50%; margin:0 auto;">
					<ul class = "pagination">
						<li class = "page-item">
							<a class = "page-link" href="#">
								Previous
							</a>
						<li>
						
						<li class = "page-item"
						 th:each = "pageNum : ${#numbers.sequence(1, cnt / 10 + ((cnt % 15 == 0) ? 0 : 1))}"
						 th:if = "${pageNum} <= 10"
						>
							<a class = "page-link" href = "#" th:text = "${pageNum}" th:onclick = "updatePagination([[${pageNum}]])"></a>
						</li>
						
						<li class = "page-item">
							<a class = "page-link" href="#">
								Next
							</a>
						<li>
					</ul>
				</nav>
			</div>
			
		</div>
		
		<!--  제이 쿼리를 쓰다 -->
		<script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js">
		</script>
		
		
		<script>
			function updatePagination(pageNumber)
			{
				console.log(`클릭한 페이지 넘버 : ${pageNumber}`);
				
				$.ajax
				({
					  type : 'GET'
					, url : '/employees/pageData'
					, contentType : 'application/json'
					, data : { pageNumber : pageNumber }
					, success : function (employees)
					{
						console.log("가져온 데이터는 아래와 같음");
						console.log(employees)
						if (employees)
						{
							var tbody = $('tbody');
							tbody.empty();
							
							$.each(employees, function (index, employee){
								var row = $('<tr>');
								var emp_no = $('<td scope="row">').		text(employee.emp_no);
								var birth_date = $('<td scope="row">').	text(employee.birth_date);
								var first_name = $('<td scope="row">'). text(employee.first_name);
								var last_name = $('<td scope="row">').  text(employee.last_name);
								var gender = $('<td scope="row">').     text(employee.gender);
								var hire_date = $('<td scope="row">').  text(employee.hire_date);
								
								row.append(emp_no, birth_date, first_name, last_name, gender, hire_date);
								tbody.append(row);
							})
						}
						else alert("망함");
					}
					, error : function () { alert("알수 없는 망함"); }
				})
			}
		</script>
		
		
	</body>
</html>
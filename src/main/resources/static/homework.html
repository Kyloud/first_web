<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Homework</title>
    </head>
    
    <body>
        <h2>학생 점수 입력</h2>
        
        <label for = "inputName">이름 :</label>
        <input type ="text" id = "inputName"  onkeydown = "checkEnter(event)">
        
        <label for = "inputScore">점수 :</label>
        <input type = "text" id = "inputScore" onkeydown = "checkEnter(event)">
        
        <button id = "scoreBtn" onclick = "addStudent()">입력</button>
		
		<p></p>
		
        <table>
	        <thead>
	            <tr>
	                <th scope="col" id = "column">이름</th>
	                <th scope="col" id = "column">점수</th>
	                <th scope="col" id = "column">동작</th>
	            </tr>
        	</thead>
        	
        	<tbody id = "tableBody">
        	
        	</tbody>
        </table>
        
        <p></p>
        
        <button onclick = "showAvg()">평균</button>
        <button onclick = "showSum()">합계</button>
        
        <p></p>
        
        <div id = result></div>
    </body>
    
    
	<style>
        table{ border-collapse : collapse; }
        th,td
        {
             text-align: center;
             border: 1px solid #000;
             padding: 10px;
        }
    </style>


	<script>
	
		function colorChangeYellow(rowNode)
		{
			rowNode.style.backgroundColor = 'yellow';
		}
		
		
		function colorChangeWhite(rowNode)
		{
			rowNode.style.backgroundColor = 'white';
		}
		
		
		function checkEnter (event) {
			if (event.key == 'Enter') {
				addStudent();
			}
		}
		
		
		
        function addStudent()
        {
            const inputName = document.getElementById('inputName');
            const inputScore = document.getElementById('inputScore');
			
            if (!inputName.value || !inputScore.value)
            {
            	inputName.focus();
				alert("이름과 점수를 모두 입력해주세요!!!"); 
            	return;
            }
            
            // console.log(inputName);
            // console.log(inputScore);

            var nameNode = document.createElement("td");
            nameNode.textContent = inputName.value;
            nameNode.scope = "row";
            nameNode.id = "name";

            var scoreNode = document.createElement("td");
            scoreNode.textContent = inputScore.value;
            scoreNode.scope = "row";
            scoreNode.id = "score";

            var buttonNode = document.createElement("td")
            	var button = document.createElement("button");
            	button.textContent = "삭제";
            	button.id = "removeBtn";
            	button.setAttribute("onclick", "removeStudent(this)");
            buttonNode.append(button);

            var rowNode = document.createElement("tr");
            rowNode.setAttribute("onmouseover", "colorChangeYellow(this)")
            rowNode.setAttribute("onmouseout", "colorChangeWhite(this)")
            rowNode.append(nameNode);
            rowNode.append(scoreNode);
            rowNode.append(buttonNode);

            var parentNode = document.querySelector("tbody");
            parentNode.append(rowNode);
		}
        
        
        function removeStudent(thisNode)
        {
        	var targetRowNode = thisNode.parentNode.parentNode;
        	targetRowNode.remove();        	

        	/*
        	let i = rows.length - 1;
        	while(!rows[i].cells[1]) i--;
        	
        	rows[i].removeChild(rows[i].cells[1])
        	*/
        	
        	/*
        	for (let i = 0; i < rows.length; i++)
        	{        		
        		for (let j = 0; j < rows[i].cells.length; j++)
            	{
        			if (rows[i].cells[j].id == "score") {
        				rows[i].cells[j].remove();
        			}
        		}
        	}
        	*/
        	
        	
        }
        
        
        
        function showAvg()
        {
            var resultNode = document.getElementById('result');

            let scoreList = [];
            let sum = 0;
            const elems = document.getElementsByTagName("td");
            
            for (let i = 0; i < elems.length; i++)
            {
                if (elems[i].id == "score")
                {
                    scoreList.push(parseInt(elems[i].innerHTML));
                }
            }
            
            for (let score of scoreList)
            {
                sum += score;
            }

            resultNode.innerHTML = `평균 : ${sum / scoreList.length}`;
        }

        
        
        
        function showSum()
        {
            var resultNode = document.getElementById('result');

            let scoreList = [];
            let sum = 0;

            const elems = document.getElementsByTagName("td");
            
            for (let i = 0; i < elems.length; i++)
            {
                if (elems[i].id == "score")
                {
                    scoreList.push(parseInt(elems[i].innerHTML));
                }
            }
            
            for (let score of scoreList)
            {
                sum += score;
            }

            resultNode.innerHTML = `합계 : ${sum}`;
        }
	</script>
    

</html>
